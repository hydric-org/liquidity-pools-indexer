enum PoolType {
  V2
  V3
  V4
  ALGEBRA
  SLIPSTREAM
}

enum HistoricalDataInterval {
  HOURLY
  DAILY
}

enum StatsTimeframe {
  DAY
  WEEK
  MONTH
  QUARTER
}

type Token
  @index(fields: ["name", "trackedTotalValuePooledUsd"])
  @index(fields: ["symbol", "trackedTotalValuePooledUsd"])
  @index(fields: ["chainId", "trackedTotalValuePooledUsd"]) {
  id: ID!
  tokenAddress: String! @index

  usdPrice: BigDecimal!
  trackedUsdPrice: BigDecimal!
  trackedPriceDiscoveryCapitalUsd: BigDecimal!
  decimals: Int!

  totalValuePooledUsd: BigDecimal!
  trackedTotalValuePooledUsd: BigDecimal! @index

  tokenTotalValuePooled: BigDecimal!

  swapVolumeUsd: BigDecimal!
  trackedSwapVolumeUsd: BigDecimal! @index

  tokenSwapVolume: BigDecimal!

  liquidityVolumeUsd: BigDecimal!
  trackedLiquidityVolumeUsd: BigDecimal! @index

  tokenLiquidityVolume: BigDecimal!
  tokenFees: BigDecimal!
  feesUsd: BigDecimal!
  trackedFeesUsd: BigDecimal!

  symbol: String! @index
  name: String! @index
  chainId: Int! @index

  poolsCount: Int! @index
  swapsCount: Int! @index
  swapsInCount: Int!
  swapsOutCount: Int!
}

type Pool
  @index(fields: ["chainId", "trackedTotalValueLockedUsd"])
  @index(fields: ["token0", "token1", "trackedTotalValueLockedUsd"]) {
  id: ID!
  poolAddress: String! @index

  token0: Token! @index
  token1: Token! @index

  rawCurrentFeeTier: Int!
  rawInitialFeeTier: Int!

  positionManager: Bytes!
  protocol: Protocol! @index
  poolType: PoolType! @index

  v4PoolData: V4PoolData
  v3PoolData: V3PoolData
  algebraPoolData: AlgebraPoolData
  slipstreamPoolData: SlipstreamPoolData

  chainId: Int! @index
  isDynamicFee: Boolean!

  historicalData: [PoolHistoricalData!]! @derivedFrom(field: "pool")

  createdAtBlock: BigInt!
  createdAtTimestamp: BigInt! @config(precision: 12)

  lastActivityBlock: BigInt! @index
  lastActivityTimestamp: BigInt! @config(precision: 12)

  totalValueLockedUsd: BigDecimal! @index
  totalValueLockedToken0: BigDecimal!
  totalValueLockedToken1: BigDecimal!
  totalValueLockedToken0Usd: BigDecimal!
  totalValueLockedToken1Usd: BigDecimal!
  trackedTotalValueLockedUsd: BigDecimal! @index
  trackedTotalValueLockedToken0Usd: BigDecimal!
  trackedTotalValueLockedToken1Usd: BigDecimal!

  accumulatedYield: BigDecimal! @config(precision: 18, scale: 6)

  feesUsd: BigDecimal!
  feesToken0: BigDecimal!
  feesToken1: BigDecimal!
  trackedFeesUsd: BigDecimal!

  swapVolumeUsd: BigDecimal!
  swapVolumeToken0: BigDecimal!
  swapVolumeToken1: BigDecimal!
  swapVolumeToken0Usd: BigDecimal!
  swapVolumeToken1Usd: BigDecimal!
  trackedSwapVolumeUsd: BigDecimal!
  trackedSwapVolumeToken0Usd: BigDecimal!
  trackedSwapVolumeToken1Usd: BigDecimal!

  liquidityVolumeUsd: BigDecimal!
  liquidityVolumeToken0: BigDecimal!
  liquidityVolumeToken1: BigDecimal!
  liquidityVolumeToken0Usd: BigDecimal!
  liquidityVolumeToken1Usd: BigDecimal!
  trackedLiquidityVolumeUsd: BigDecimal!
  trackedLiquidityVolumeToken0Usd: BigDecimal!
  trackedLiquidityVolumeToken1Usd: BigDecimal!

  liquidityNetInflowUsd: BigDecimal!
  trackedLiquidityNetInflowUsd: BigDecimal!

  totalStats24h: PoolTimeframedStats!
  totalStats7d: PoolTimeframedStats!
  totalStats30d: PoolTimeframedStats!
  totalStats90d: PoolTimeframedStats!

  swapsCount: Int!

  tokens0PerToken1: BigDecimal!
  tokens1PerToken0: BigDecimal!
}

type V3PoolData {
  id: ID!
  tick: BigInt! @config(precision: 7)
  sqrtPriceX96: BigInt!
  tickSpacing: Int!
}

type SlipstreamPoolData {
  id: ID!
  tick: BigInt! @config(precision: 7)
  sqrtPriceX96: BigInt!
  tickSpacing: Int!
  lastFeeAdjustmentTimestamp: BigInt! @config(precision: 12)
}

type AlgebraPoolData {
  id: ID!
  deployer: String!
  rawCommunityFee: Int!
  plugin: String!
  pluginConfig: Int!
  version: String!
  tick: BigInt! @config(precision: 7)
  sqrtPriceX96: BigInt!
  tickSpacing: Int!
}

type V4PoolData {
  id: ID!
  hooks: Bytes!
  tick: BigInt! @config(precision: 7)
  sqrtPriceX96: BigInt!
  tickSpacing: Int!
  permit2: Bytes!
  poolManager: Bytes!
  stateView: Bytes
}

type PoolTimeframedStats {
  id: ID!
  pool: Pool! @index
  timeframe: StatsTimeframe!

  dataPointTimestamp: BigInt! @config(precision: 12)
  lastRefreshTimestamp: BigInt! @config(precision: 12)

  liquidityNetInflowUsd: BigDecimal!
  trackedLiquidityNetInflowUsd: BigDecimal! @index

  swapVolumeUsd: BigDecimal!
  trackedSwapVolumeUsd: BigDecimal! @index

  liquidityVolumeUsd: BigDecimal!
  trackedLiquidityVolumeUsd: BigDecimal! @index

  feesUsd: BigDecimal!
  trackedFeesUsd: BigDecimal! @index

  yearlyYield: BigDecimal! @index @config(precision: 18, scale: 6)
  accumulatedYield: BigDecimal! @config(precision: 18, scale: 6)
}

type PoolHistoricalData @index(fields: ["pool", "interval", "timestampAtStart"]) {
  id: ID!
  pool: Pool! @index
  interval: HistoricalDataInterval! @index

  timestampAtStart: BigInt! @index @config(precision: 12)
  timestampAtEnd: BigInt! @config(precision: 12)

  accumulatedYieldAtStart: BigDecimal! @config(precision: 18, scale: 6)
  accumulatedYieldAtEnd: BigDecimal! @config(precision: 18, scale: 6)

  feesUsdAtStart: BigDecimal!
  feesUsdAtEnd: BigDecimal!
  trackedFeesUsdAtStart: BigDecimal!
  trackedFeesUsdAtEnd: BigDecimal!

  swapVolumeUsdAtStart: BigDecimal!
  swapVolumeUsdAtEnd: BigDecimal!
  trackedSwapVolumeUsdAtStart: BigDecimal!
  trackedSwapVolumeUsdAtEnd: BigDecimal!

  liquidityNetInflowUsdAtStart: BigDecimal!
  liquidityNetInflowUsdAtEnd: BigDecimal!
  trackedLiquidityNetInflowUsdAtStart: BigDecimal!
  trackedLiquidityNetInflowUsdAtEnd: BigDecimal!

  totalValueLockedUsdAtStart: BigDecimal!
  totalValueLockedUsdAtEnd: BigDecimal!
  trackedTotalValueLockedUsdAtStart: BigDecimal!
  trackedTotalValueLockedUsdAtEnd: BigDecimal!

  totalValueLockedToken0AtStart: BigDecimal!
  totalValueLockedToken0AtEnd: BigDecimal!

  totalValueLockedToken1AtStart: BigDecimal!
  totalValueLockedToken1AtEnd: BigDecimal!

  liquidityVolumeUsdAtStart: BigDecimal!
  liquidityVolumeUsdAtEnd: BigDecimal!
  trackedLiquidityVolumeUsdAtStart: BigDecimal!
  trackedLiquidityVolumeUsdAtEnd: BigDecimal!

  intervalSwapVolumeToken0: BigDecimal!
  intervalSwapVolumeToken1: BigDecimal!
  intervalSwapVolumeUsd: BigDecimal!

  intervalLiquidityVolumeUsd: BigDecimal!
  intervalLiquidityVolumeToken0: BigDecimal!
  intervalLiquidityVolumeToken1: BigDecimal!

  intervalLiquidityNetInflowUsd: BigDecimal!
  intervalLiquidityNetInflowToken0: BigDecimal!
  intervalLiquidityNetInflowToken1: BigDecimal!

  intervalLiquidityInflowUsd: BigDecimal!
  intervalLiquidityInflowToken0: BigDecimal!
  intervalLiquidityInflowToken1: BigDecimal!

  intervalLiquidityOutflowUsd: BigDecimal!
  intervalLiquidityOutflowToken0: BigDecimal!
  intervalLiquidityOutflowToken1: BigDecimal!

  intervalFeesUsd: BigDecimal!
  intervalFeesToken0: BigDecimal!
  intervalFeesToken1: BigDecimal!
}

type Protocol {
  id: String!
  name: String!
  logo: String!
  url: String!
  pools: [Pool!]! @derivedFrom(field: "protocol")
}
